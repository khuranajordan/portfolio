---
phase: 02-theme-system
plan: 01
type: execute
domain: ui-design
---

<objective>
Implement theme provider with next-themes for light/dark mode management.

Purpose: Establish theme state management with user preference persistence and system preference detection.
Output: Working theme provider with automatic dark mode detection and localStorage persistence.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-setup/01-01-SUMMARY.md
@.planning/phases/01-foundation-setup/01-02-SUMMARY.md
@.planning/phases/01-foundation-setup/01-03-SUMMARY.md
@package.json
@src/App.tsx
@src/main.tsx
@tailwind.config.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install next-themes and configure provider</name>
  <files>package.json, src/components/theme-provider.tsx</files>
  <action>
Install next-themes library and create theme provider component.

Steps:
1. Run: npm install next-themes
2. Create src/components/theme-provider.tsx

Create theme-provider.tsx with:
```tsx
import { ThemeProvider as NextThemesProvider } from 'next-themes';
import { type ThemeProviderProps } from 'next-themes/dist/types';

export function ThemeProvider({ children, ...props }: ThemeProviderProps) {
  return <NextThemesProvider {...props}>{children}</NextThemesProvider>;
}
```

Provider configuration:
- attribute="class" (uses class-based dark mode from Phase 1)
- defaultTheme="system" (respects user's system preference)
- enableSystem=true (allows system preference detection)
- disableTransitionOnChange=false (enables smooth transitions)

These props will be passed when we use the provider in next task.

Verify:
- next-themes added to package.json dependencies
- theme-provider.tsx exports ThemeProvider component
- No TypeScript errors
  </action>
  <verify>
- package.json contains next-themes in dependencies
- src/components/theme-provider.tsx exists with proper TypeScript types
- npm run build completes without errors
  </verify>
  <done>
next-themes installed and theme provider component created
  </done>
</task>

<task type="auto">
  <name>Task 2: Integrate provider with App component</name>
  <files>src/main.tsx, src/App.tsx</files>
  <action>
Wrap App with ThemeProvider and configure props.

Update src/main.tsx:
```tsx
import { StrictMode } from 'react';
import { ThemeProvider } from '@/components/theme-provider';
import './index.css';
import App from './App';

createRoot(document.getElementById('root')!).render(
  <StrictMode>
    <ThemeProvider
      attribute="class"
      defaultTheme="system"
      enableSystem
      disableTransitionOnChange={false}
    >
      <App />
    </ThemeProvider>
  </StrictMode>,
);
```

Update src/App.tsx to test theme awareness:
```tsx
import { useTheme } from 'next-themes';

function App() {
  const { theme, setTheme } = useTheme();

  return (
    <div className="min-h-screen bg-background text-foreground p-8">
      <div className="max-w-4xl mx-auto space-y-4">
        <h1 className="text-3xl font-bold">Theme System Test</h1>
        <p className="text-muted-foreground">
          Current theme: {theme}
        </p>
        <div className="flex gap-2">
          <button
            onClick={() => setTheme('light')}
            className="px-4 py-2 rounded border"
          >
            Light
          </button>
          <button
            onClick={() => setTheme('dark')}
            className="px-4 py-2 rounded border"
          >
            Dark
          </button>
          <button
            onClick={() => setTheme('system')}
            className="px-4 py-2 rounded border"
          >
            System
          </button>
        </div>
      </div>
    </div>
  );
}

export default App;
```

This creates a simple test to verify theme switching works.
  </action>
  <verify>
- src/main.tsx wraps App with ThemeProvider
- src/App.tsx uses useTheme hook
- npm run dev runs without errors
- Theme toggles work (test by clicking buttons)
- Theme persists across page refreshes (check localStorage)
- System theme preference is detected correctly
  </verify>
  <done>
ThemeProvider integrated and theme switching functional
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] next-themes installed
- [ ] ThemeProvider component created
- [ ] Provider wraps App in main.tsx
- [ ] useTheme hook accessible in components
- [ ] Theme switching works (light/dark/system)
- [ ] Theme persists in localStorage
- [ ] System preference detection works
</verification>

<success_criteria>
- All tasks completed
- Theme provider fully functional
- Theme state managed by next-themes
- Persistence working
- Ready for theme toggle component
</success_criteria>

<output>
After completion, create `.planning/phases/02-theme-system/02-01-SUMMARY.md`:

# Phase 2 Plan 1: Implement Theme Provider Summary

**next-themes library integrated with ThemeProvider, enabling light/dark mode with system preference detection and localStorage persistence**

## Accomplishments
- next-themes library installed
- ThemeProvider component created
- Provider integrated with App
- Theme state management functional
- System preference detection working
- localStorage persistence confirmed

## Files Created/Modified
- `package.json` - Added next-themes dependency
- `src/components/theme-provider.tsx` - Theme provider wrapper
- `src/main.tsx` - Integrated ThemeProvider
- `src/App.tsx` - Test layout with theme controls

## Decisions Made
- next-themes instead of manual implementation (proven library, handles edge cases)
- Class-based dark mode (matches Tailwind config from Phase 1)
- System preference as default (respects user OS settings)
- Transitions enabled (will add smooth animations in next plan)

## Deviations from Plan
None - plan executed as specified.

## Issues Encountered
None

## Next Step
Ready for 02-02-PLAN.md (Create theme toggle component)
</output>
