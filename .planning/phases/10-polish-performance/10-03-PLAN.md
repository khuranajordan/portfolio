---
phase: 10-polish-performance
plan: 03
type: execute
domain: ui-design
---

<objective>
Optimize performance with bundle size reduction, lazy loading, code splitting, and image optimization.

Purpose: Ensure fast load times, smooth interactions, and excellent Lighthouse scores.
Output: Optimized site with < 1s initial load, lazy loaded components, and efficient bundle.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shic-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@vite.config.js
@src/main.tsx
@src/App.tsx
@package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Configure Vite for optimal bundle size and performance</name>
  <files>vite.config.js</files>
<action>
Configure Vite with production optimizations, code splitting, and bundle analysis.

Update vite.config.js:
```js
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';

export default defineConfig({
  plugins: [
    react({
      jsxImportSource: '@emotion/react',
      babel: {
        plugins: ['babel-plugin-macros']
      }
    })
  ],
  build: {
    // Output directory
    outDir: 'dist',
    // Generate sourcemaps for production (optional, disable for smaller bundles)
    sourcemap: false,
    // Minify
    minify: 'terser',
    terserOptions: {
      compress: {
        drop_console: true,
        drop_debugger: true
      }
    },
    // Chunk size warnings
    chunkSizeWarningLimit: 1000,
    // Rollup options
    rollupOptions: {
      output: {
        // Manual chunks for vendor splitting
        manualChunks: {
          'react-vendor': ['react', 'react-dom'],
          'framer-motion': ['framer-motion'],
          'lucide-react': ['lucide-react'],
          'radix-vendor': [
            '@radix-ui/react-slot',
            '@radix-ui/react-separator',
            '@radix-ui/react-dropdown-menu',
            '@radix-ui/react-dialog'
          ]
        },
        // Asset naming
        assetFileNames: 'assets/[name]-[hash][extname]',
        chunkFileNames: 'assets/[name]-[hash].js',
        entryFileNames: 'assets/[name]-[hash].js'
      }
    },
    // CSS code splitting
    cssCodeSplit: true
  },
  // Dependencies optimization
  optimizeDeps: {
    include: ['react', 'react-dom', 'framer-motion', 'lucide-react']
  },
  // Server configuration
  server: {
    port: 3000,
    open: true
  }
});
```

Optimizations:
- Code splitting by vendor
- Terser minification with console removal
- CSS code splitting
- Chunk size limit (1000KB)
- Hashed filenames for caching
- Dependency pre-bundling
  </action>
  <verify>
- vite.config.js updated
- Build completes without errors
- Chunks generated correctly
- Sourcemaps disabled (production)
- Console removal configured
  </verify>
  <done>
Vite configured for performance
  </done>
</task>

<task type="auto">
  <name>Task 2: Implement lazy loading for components and routes</name>
  <files>src/App.tsx, src/main.tsx</files>
<action>
Add React.lazy() and Suspense for code splitting heavy components.

Update src/App.tsx with lazy loading:
```tsx
import { lazy, Suspense } from 'react';
import { Navigation } from '@/components/navigation';
import { HeroSection } from '@/components/hero-section';
import { Footer } from '@/components/footer';

// Lazy load heavy sections below the fold
const ExperienceSection = lazy(() => import('@/components/experience-section').then(m => ({ default: m.ExperienceSection })));
const SkillsSection = lazy(() => import('@/components/skills-section').then(m => ({ default: m.SkillsSection })));
const ProjectsSection = lazy(() => import('@/components/projects-section').then(m => ({ default: m.ProjectsSection })));
const AboutSection = lazy(() => import('@/components/about-section').then(m => ({ default: m.AboutSection })));
const ContactSection = lazy(() => import('@/components/contact-section').then(m => ({ default: m.ContactSection })));

// Loading fallback component
function SectionLoader() {
  return (
    <div className="flex items-center justify-center py-20">
      <div className="flex gap-2">
        <div className="w-3 h-3 bg-primary rounded-full animate-bounce [animation-delay:-0.3s]" />
        <div className="w-3 h-3 bg-primary rounded-full animate-bounce [animation-delay:-0.15s]" />
        <div className="w-3 h-3 bg-primary rounded-full animate-bounce" />
      </div>
    </div>
  );
}

function App() {
  return (
    <div className="min-h-screen bg-background">
      <Navigation />
      <HeroSection />

      {/* Lazy loaded sections with Suspense */}
      <Suspense fallback={<SectionLoader />}>
        <ExperienceSection />
      </Suspense>

      <Suspense fallback={<SectionLoader />}>
        <SkillsSection />
      </Suspense>

      <Suspense fallback={<SectionLoader />}>
        <ProjectsSection />
      </Suspense>

      <Suspense fallback={<SectionLoader />}>
        <AboutSection />
      </Suspense>

      <Suspense fallback={<SectionLoader />}>
        <ContactSection />
      </Suspense>

      <Footer />
    </div>
  );
}
```

Update src/main.tsx:
```tsx
import { StrictMode } from 'react';
import { createRoot } from 'react-dom/client';
import './index.css';
import App from './App';

createRoot(document.getElementById('root')!).render(
  <StrictMode>
    <App />
  </StrictMode>
);
```

Lazy loading strategy:
- Eager load: Navigation, Hero (above fold)
- Lazy load: Experience, Skills, Projects, About, Contact (below fold)
- Suspense boundaries with loading fallback
- Animated loading indicator
  </action>
  <verify>
- Lazy loading implemented
- Suspense boundaries added
- Loading component displays
- No hydration errors
- Initial bundle reduced
- Lazy chunks generated
  </verify>
  <done>
Lazy loading implemented for sections
  </done>
</task>

<task type="auto">
  <name>Task 3: Add bundle analyzer and performance monitoring</name>
  <files>package.json</files>
<action>
Install and configure bundle analyzer for monitoring bundle size.

Update package.json:
```json
{
  "name": "portfolio",
  "private": true,
  "version": "1.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview",
    "lint": "eslint . --ext ts,tsx --report-unused-disable-directives --max-warnings 0",
    "analyze": "vite-bundle-visualizer"
  },
  "dependencies": {
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "framer-motion": "^11.0.0",
    "lucide-react": "^0.344.0",
    "next-themes": "^0.3.0",
    "clsx": "^2.1.0",
    "tailwind-merge": "^2.2.0"
  },
  "devDependencies": {
    "@types/react": "^18.2.56",
    "@types/react-dom": "^18.2.19",
    "@typescript-eslint/eslint-plugin": "^6.21.0",
    "@typescript-eslint/parser": "^6.21.0",
    "@vitejs/plugin-react": "^4.2.1",
    "vite": "^5.1.4",
    "typescript": "^5.3.3",
    "tailwindcss": "^3.4.1",
    "postcss": "^8.4.35",
    "autoprefixer": "^10.4.17",
    "eslint": "^8.56.0",
    "eslint-plugin-react-hooks": "^4.6.0",
    "eslint-plugin-react-refresh": "^0.4.5",
    "vite-bundle-visualizer": "^1.0.0"
  }
}
```

Then install:
```bash
npm install vite-bundle-visualizer --save-dev
```

Usage:
```bash
npm run build
npm run analyze
```

This will open an interactive visualization of the bundle.
  </action>
  <verify>
- vite-bundle-visualizer installed
- npm run analyze script added
- Bundle visualization works
- Dependencies installed
  </verify>
  <done>
Bundle analyzer configured
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Vite config optimized
- [ ] Lazy loading implemented
- [ ] Suspense boundaries added
- [ ] Bundle analyzer installed
- [ ] Build completes successfully
- [ ] Initial bundle size reduced
- [ ] Chunks generated correctly
- [ ] No console errors
</verification>

<success_criteria>
- All tasks completed
- Build optimized
- Lazy loading working
- Bundle analyzer functional
- Initial bundle < 200KB gzipped
- Chunks split by vendor
- Ready for final polish
</success_criteria>

<output>
After completion, create `.planning/phases/10-polish-performance/10-03-SUMMARY.md`:

# Phase 10 Plan 3: Performance Optimization Summary

**Bundle size reduction, lazy loading, and performance monitoring**

## Accomplishments
- Vite configured with Terser minification
- Manual chunk splitting (React, Framer Motion, Lucide, Radix)
- Console removal in production
- CSS code splitting enabled
- React.lazy() for below-fold sections
- Suspense boundaries with loading fallback
- Animated loading indicator
- vite-bundle-visualizer installed
- npm run analyze script added
- Dependency pre-bundling

## Files Created/Modified
- `vite.config.js` - Performance optimizations
- `src/App.tsx` - Lazy loading
- `package.json` - Bundle analyzer

## Decisions Made
- Eager load hero/nav (above fold)
- Lazy load everything else (below fold)
- Manual chunk splitting (control)
- Terser minification (smaller bundle)
- No console in production (clean)
- Chunk size limit 1000KB (reasonable)
- Bundle visualization (monitoring)

## Deviations from Plan
None - plan executed as specified.

## Issues Encountered
None

## Next Step
Ready for 10-04-PLAN.md (Final polish with Lighthouse)
</output>
